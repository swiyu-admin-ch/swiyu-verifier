package ch.admin.bit.eid.oid4vp.model;

import ch.admin.bit.eid.oid4vp.model.persistence.ManagementEntity;
import com.authlete.sd.Disclosure;
import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jws;
import io.jsonwebtoken.Jwt;
import io.jsonwebtoken.JwtParser;
import io.jsonwebtoken.Jwts;
import lombok.extern.slf4j.Slf4j;

import java.security.KeyFactory;
import java.security.PublicKey;
import java.security.spec.EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;
import java.time.Instant;
import java.util.Arrays;
import java.util.Base64;
import java.util.Collections;
import java.util.List;
import java.util.Objects;

@Slf4j
public class SDJWTCredential extends CredentialBuilder {

    private final String publicKeyString = "-----BEGIN PUBLIC KEY-----\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQgjeqGSdu+2jq8+n78+6fXk2Yh22\nlQKBYCnu5FWPvKtat3wFEsQXqNHYgPXBxWmOBw5l2PE/gUDUJqGJSc1LuQ==\n-----END PUBLIC KEY-----\n";
    private final String tokenString = "eyJ0eXAiOiJ2YytzZC1qd3QiLCJhbGciOiJFUzI1NiJ9.eyJpc3MiOiJkaWQ6ZXhhbXBsZToxMjM0NTY3ODkiLCJfc2QiOlsiNFF0REs3bC1KS2dBWU9SaHVna3lQNWx1RXJzQzNpblVkNlZUTXFBYXc3RSIsIkNVYUtnbmFRWEpKcDJvS0kxVDhwaW1meUYwSUZ0TzA3TWY3Rm8weVlBVGsiLCJEbFJEa1FKeVlpaFd6VFZqZzVvdjNEQm9UVnpaX3k2RVRUR2dPei0zazNvIiwiRHQyLVRuLXVqcGowLTI3WXJQWWU5VVlnQzZJN1dOQ2VXX3ozRDhTWDN4USIsIkdlbWFhYUtKb1hJbFkwSG5tNVh5VGZIWF84cXRnYXdOa1RuZjI2MFFWenMiLCJLVTdORWRlTzR5U1Q2RHdPWlhrRGFZUUI5Z3FsMWM4Y1F2cWJ3c2NmdXY0IiwiTldreHhQQy1wUC1IS0ZQcmF3Z3R5bGxLOEZHZy1YeUFzWVZLUF81UzVvZyIsIk5tbmxnU2MwS2t1WFp1T3VUaXFiTDNma0tFaFNNOG95NnJPUWFaZFYwRkkiLCJPcmRLUDhIcGNOYWNpSldmNFAtMUdMYlI1Q3RQVS1IUE9zZ0dPYnNNMDc4IiwiUFNSUmlpd0t3by1SbExCT215OVU5bUFRNXhGVXdHTjJWU0hCa2lHLVQxNCIsIlE2RllIOHJxLTI0UFFDU2xQZ01ra2xqa3lGeGhlZV93ZDRWckZTZVRRamMiLCJVOWtCQjVyWXJaR2hRM25Ddmd2ZExXaG51MkJuZExxeW1VRXN1VHNIWnlzIiwiV29wSGw5bkhyWmY3d2NWd0tiQVBXempTNTBreGFYR0ZFQ0hwUXZUcXhjRSIsIlhaMWF5cVFpdDhNdEpUUGZOYXd2LV9ObDExbkE1QWx2YjBycHJndDg5Q0kiLCJsUmpZZ2w5UUpZVU5sLXJrdGRYb0JzVmpoYUVEcERtZEx6aVJlTFNWLUQ0IiwiblFOTXV2RDFNTmZNV0xWYWI3U29XRjZFc2t6OEQ4Ym9SeGhQdnhoR0ExYyIsInpHWU9zT0JYY25NdjQteTZmcUhucGQzUjlyU0QwM3NTeW40Z0dfeDJORUkiXSwiaWF0IjoxNzIzMTAzMjM4fQ.miEAXvMAq_wEwWNjnipkVFF_biw5N-jUmWcoLkrNKIg5NlBZ8uvumXXaRW5sOACYHsQ5jlwM4kO8a2oSAUD65A~WyJFU0lDeHMxbk11b1ByWkY0OXUyVkRRIiwibGFzdE5hbWUiLCJNdXN0ZXIiXQ~WyJ2a1FCOXIwek5lSTlTRGxWY0hSYmdRIiwiaXNzdWVyRW50aXR5IiwiU3RyYXNzZW52ZXJrZWhyc2FtdCBBUiJd~WyJxQ3ltek92RWw5M2laNmsxT0ZMcXNnIiwiaG9tZXRvd24iLCJIZXJpc2F1Il0~WyJXZFZrTVJRSm9kaTdOVk1ReXVJT3BRIiwicG9saWNlUVJJbWFnZSIsImlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFQVUFBQUR6Q0FZQUFBQmU2RkI0QUFBQUFYTlNSMElBcnM0YzZRQUFBQVJuUVUxQkFBQ3hqd3Y4WVFVQUFBQUpjRWhaY3dBQUZpVUFBQllsQVVsU0pQQUFBQnVKU1VSQlZIaGU3ZHd4cm14WDFVVmhXa0R1dmhBNG9BWDBnQllRa0RpemNJaUk2SUZ6cHdSRURoQXBvZ2NrQklqTUhiRC91L0dWcmloLysvMXozN25QcWFyTEdkS1FBOFphNjlSN2JDRWh4TTkrdUxpNCtGQmNqL3JpNG9OeFBlcUxpdy9HOWFndkxqNFkxNk8rdVBoZ1hJLzY0dUtEY1QzcWk0c1B4dldvTHk0K0dOZWp2cmo0WUV3ZjljOSs5ck9IOFp0dnZubjlxdmVoblNMdFV0cDk3Znd0Wit4ckZXbVhrdTc3NHgvL3lQWWUvdnpuUDMvOXF2K2Y2WitPRnQvTDYxRy9iLzZXTS9hMWlyUkxTZmRkai9wQXIwZjl2dmxienRqWEt0SXVKZDEzUGVvRHZSNzErK1p2T1dOZnEwaTdsSFRmOWFnUDlIclU3NXUvNVl4OXJTTHRVdEo5L3hPUCtydnZ2bnY5VjQvanE2Kysrc25kMmFPKzdZWkNuUlJOMXlvZXZadWgrVlN4dXhONjFMLy8vZTlmLzlYaitOZS8vdldUdTllanZrR2RGRTNYS2g2OW02SDVWTEc3RTllajNzVDFxTjhVajk3TjBIeXEyTjJKNjFGdjRuclViNHBINzJab1BsWHM3c1QxcURkeFBlbzN4YU4zTXpTZktuWjM0bi8yVVgvMjJXZHNFNy8rK3V2WExXK3NQT3FVMjMwcml0M2RRSzBVdTd1VWxYMXFwVkFuUmRxSjlGRi8rZVdYUCtsU2YvR0xYN3h1ZWVONjFBRzMrMVlVdTd1QldpbDJkeWtyKzlSS29VNkt0QlBYbzM2SDE2TitRNjBVdTd1VWxYMXFwVkFuUmRxSjYxRy93K3RSdjZGV2l0MWR5c28rdFZLb2t5THR4UFdvMytIMXFOOVFLOFh1TG1WbG4xb3AxRW1SZHVKNjFPK3dmZFMzM1lvcG1rMFY2b1lOelQ3Tk5zNVlhUlBTZmVxa3VCNzFPN3dlOWFmYmxHYWZaaHRuckxRSjZUNTFVbHlQK2gxZWovclRiVXF6VDdPTk0xYmFoSFNmT2ltdVIvME9yMGY5NlRhbDJhZlp4aGtyYlVLNlQ1MFUxNk4raDllai9uU2IwdXpUYk9PTWxUWWgzYWRPaXV0UnY4UDJVWXZiMlpraTdWTGFmWm8vd3didGV3YkY5YWpmNGZXb1A0M216N0JCKzU1QmNUM3FkM2c5NmsraitUTnMwTDVuVUZ5UCtoMWVqL3JUYVA0TUc3VHZHUlRYbzM2SDE2UCtOSm8vd3didGV3YkYvK3lqL3V0Zi8vckR0OTkrK3k3SHg5K3k4cWh2dTJIREdmdFdGR21Yb24xU3BOME16VXVSZGczcG8vN0hQLzdCZjM4bi91MXZmM3ZkOHNiZEgvVnVya2Y5cGtpN0ZPMlRJdTFtYUY2S3RHdElIL1Z1cmtkOVk4TVorMVlVYVplaWZWS2szUXpOUzVGMkRkZWozc1QxcU44VWFaZWlmVktrM1F6TlM1RjJEZGVqM3NUMXFOOFVhWmVpZlZLazNRek5TNUYyRFIvcVVYLy8vZmMvV1RyODRvc3YvdlBmOUIzcDU1OS8vcE83N2FOKzlHNlF0cy9ZRGNXamQzclV2L3psTC9udjI1Mys5cmUvL2NuZHcvNlQrbDVlai9xTloreUc0dEU3UGVwN2VUM3FHeDY5RzZUdE0zWkQ4ZWpkOWFnUDlIclVienhqTnhTUDNsMlAra0N2Ui8zR00zWkQ4ZWpkaDN2VStsKy8zTXQvLy92ZnIxLzEzK2pIaTBmdkJtbjdqTjFRUEhyM3ozLytrLzkrdklkLytjdGZYci9xLzhlLzVvblJYNWdVNnFSUUoxZlF2R3pRUHRtaW5WS29reW5ON0RQd3NYN05DL29MazBLZEZPcmtDcHFYRGRvblc3UlRDblV5cFpsOUJqN1dyM2xCZjJGU3FKTkNuVnhCODdKQisyU0xka3FoVHFZMHM4L0F4L28xTCtndlRBcDFVcWlUSzJoZU5taWZiTkZPS2RUSmxHYjJHZmhZditZRi9ZVkpvVTRLZFhJRnpjc0c3Wk10MmltRk9wblN6RDREMDErakg3NWJvVzVGb1M3MUxIVDdYb3FtRzU1QmVsZWRGT3FHWW5lWE1wM1dvZDBLZFNzS2RhbG5vZHYzVWpUZDhBelN1K3FrVURjVXU3dVU2YlFPN1Zhb1cxR29TejBMM2I2WG91bUdaNURlVlNlRnVxSFkzYVZNcDNWb3QwTGRpa0pkNmxubzlyMFVUVGM4Zy9TdU9pblVEY1h1TG1VNnJVTzdGZXBXRk9wU3owSzM3NlZvdXVFWnBIZlZTYUZ1S0haM0tVdlRPcDU2RnJvdGhUb3BtbTVGMFhTcFF0MVpwbWoyV1UzSnl4ZDBLUFVzZEZzS2RWSTAzWXFpNlZLRnVyTk0wZXl6bXBLWEwraFE2bG5vdGhUcXBHaTZGVVhUcFFwMVo1bWkyV2MxSlM5ZjBLSFVzOUJ0S2RSSjBYUXJpcVpMRmVyT01rV3p6MnBLWHI2Z1E2bG5vZHRTcUpPaTZWWVVUWmNxMUoxbGltYWYxWlM4bktEalVxaWJlUWE2S3h1MGIyYUtabVZLTTd1QzdzaUdabDh6TzBqbjB5NmxtMzVCSHlTRnVwbG5vTHV5UWZ0bXBtaFdwalN6SytpT2JHajJOYk9EZEQ3dFVycnBGL1JCVXFpYmVRYTZLeHUwYjJhS1ptVktNN3VDN3NpR1psOHpPMGpuMHk2bG0zNUJIeVNGdXBsbm9MdXlRZnRtcG1oV3BqU3pLK2lPYkdqMk5iT0RkRDd0VXJycEYvUkJVcWliZVFhNkt4dTBiMmFLWm1WS003dUM3c2lHWmw4ek8wam4weTVsYVZySHBWQW5qMEIzWklwbVpZdDJ5cFJtVnF6c1U1c3EwazdzbmgwS2RWS2tuY2pMRjNSSUNuWHlDSFJIcG1oV3RtaW5UR2xteGNvK3Rha2k3Y1R1MmFGUUowWGFpYng4UVlla1VDZVBRSGRraW1abGkzYktsR1pXck94VG15clNUdXllSFFwMVVxU2R5TXNYZEVnS2RmSUlkRWVtYUZhMmFLZE1hV2JGeWo2MXFTTHR4Tzdab1ZBblJkcUp2SHhCaDZSUUo0OUFkMlNLWm1XTGRzcVVabGFzN0ZPYkt0Sk83SjRkQ25WU3BKMllsczNTQnQyZEtjN29wRWk3UWRvMjNSa2VnZTZraXFhYm1kTE1wa3czbm5GYzZPNU1jVVluUmRvTjByYnB6dkFJZENkVk5OM01sR1kyWmJyeGpPTkNkMmVLTXpvcDBtNlF0azEzaGtlZ082bWk2V2FtTkxNcDA0MW5IQmU2TzFPYzBVbVJkb08wYmJvelBBTGRTUlZOTnpPbG1VMlpianpqdU5EZG1lS01Ub3EwRzZSdDA1M2hFZWhPcW1pNm1Tbk5iTW9oZnd2NjhOUVZOQy9QSUwycmJzV0czZnVFYmd3Ym1uM3BiTk9kWlVyM3B6MUJINVM2Z3VibEdhUjMxYTNZc0h1ZjBJMWhRN012blcyNnMwenAvclFuNklOU1Y5QzhQSVAwcnJvVkczYnZFN294YkdqMnBiTk5kNVlwM1ovMkJIMVE2Z3FhbDJlUTNsVzNZc1B1ZlVJM2hnM052blMyNmM0eXBmdlRucUFQU2wxQjgvSU0wcnZxVm16WXZVL294ckNoMlpmT050MVpwa3hMTFpVaTdZUm1oMkozSnpTYnVvTG03MlZLTXp2UXZFelpQYnZpSXpIOUduMjRGR2tuTkRzVXV6dWgyZFFWTkg4dlU1clpnZVpseXU3WkZSK0o2ZGZvdzZWSU82SFpvZGpkQ2MybXJxRDVlNW5TekE0MEwxTjJ6Njc0U0V5L1JoOHVSZG9KelE3RjdrNW9OblVGemQvTGxHWjJvSG1ac250MnhVZGkralg2Y0NuU1RtaDJLSFozUXJPcEsyaitYcVkwc3dQTnk1VGRzeXMrRXZYWDNQTUgzdXQyZWpmdHppTDluclJiUVR0M205TE1ycUE3alNuMXIybU90OXpyZG5vMzdjNGkvWjYwVzBFN2Q1dlN6SzZnTzQwcDlhOXBqcmZjNjNaNk4rM09JdjJldEZ0Qk8zZWIwc3l1b0R1TktmV3ZhWTYzM090MmVqZnR6aUw5bnJSYlFUdDNtOUxNcnFBN2pTbjFyMm1PdDl6cmRubzM3YzRpL1o2MFcwRTdkNXZTeks2Z080MHAwMUpMcFZEWEt0UTlra0pkYTRQMnBUNGEra2Fab3RrVlU1cFpNWjNXSVNuVXRRcDFqNlJRMTlxZ2ZhbVBocjVScG1oMnhaUm1Wa3luZFVnS2RhMUMzU01wMUxVMmFGL3FvNkZ2bENtYVhUR2xtUlhUYVIyU1FsMnJVUGRJQ25XdERkcVgrbWpvRzJXS1psZE1hV2JGZEZxSHBGRFhLdFE5a2tKZGE0UDJwVDRhK2thWm90a1ZVNXBaTVozV0lkblE3a3ZuMWNuZDZNWk1zYnNUemF6UXZoVkYycVZvbnhUcXpqSmxXbXFwYkdqM3BmUHE1RzUwWTZiWTNZbG1WbWpmaWlMdFVyUlBDblZubVRJdHRWUTJ0UHZTZVhWeU43b3hVK3p1UkRNcnRHOUZrWFlwMmllRnVyTk1tWlphS2h2YWZlbThPcmtiM1pncGRuZWltUlhhdDZKSXV4VHRrMExkV2FaTVN5MlZEZTIrZEY2ZDNJMXV6QlM3TzlITUN1MWJVYVJkaXZaSm9lNHNVNmFsbHNxR2RsODZyMDd1UmpkbWl0MmRhR2FGOXEwbzBpNUYrNlJRZDVZcDB6SmRtblpDc3pPRnVqTVU2bzVRcUdzVWFUZEQ4NmxDWGFwUUoxdlNuV2tucG1XNk5PMkVabWNLZFdjbzFCMmhVTmNvMG02RzVsT0Z1bFNoVHJha085Tk9UTXQwYWRvSnpjNFU2czVRcUR0Q29hNVJwTjBNemFjS2RhbENuV3hKZDZhZG1KYnAwclFUbXAwcDFKMmhVSGVFUWwyalNMc1ptazhWNmxLRk90bVM3a3c3TVMzVHBXa25ORHRUcUR0RG9lNEloYnBHa1hZek5KOHExS1VLZGJJbDNabDJZbHBXU3pFclY5RDhibFBTMmJTYjBjeHJWdTVHTjRaaWQ1ZWlmVktvVzFHb2t5blRzbHFLV2JtQzVuZWJrczZtM1l4bVhyTnlON294Rkx1N0ZPMlRRdDJLUXAxTW1aYlZVc3pLRlRTLzI1UjBOdTFtTlBPYWxidlJqYUhZM2FWb254VHFWaFRxWk1xMHJKWmlWcTZnK2QybXBMTnBONk9aMTZ6Y2pXNE14ZTR1UmZ1a1VMZWlVQ2RUcG1XMUZMTnlCYzN2TmlXZFRic1p6YnhtNVc1MFl5aDJkeW5hSjRXNkZZVTZtZEw5NlN5Z2p6eExzYnRMMGI1aGltYnY1VDNSOXp5YUtjMnNPTzF2Umg5K2xtSjNsNko5d3hUTjNzdDdvdTk1TkZPYVdYSGEzNHcrL0N6RjdpNUYrNFlwbXIyWDkwVGY4MmltTkxQaXRMOFpmZmhaaXQxZGl2WU5VelI3TCsrSnZ1ZlJUR2xteFdsL00vcndzeFM3dXhUdEc2Wm85bDdlRTMzUG81blN6SXJwZEhwb2Q3ZENzMU96cVNtYVBjS0dNL2F0dUJ2ZGtDM2FtU3JTVGt6TGRPbnVib1ZtcDJaVFV6UjdoQTFuN0Z0eE43b2hXN1F6VmFTZG1KYnAwdDNkQ3MxT3phYW1hUFlJRzg3WXQrSnVkRU8yYUdlcVNEc3hMZE9sdTdzVm1wMmFUVTNSN0JFMm5MRnZ4ZDNvaG16UnpsU1JkbUphcGt0M2R5czBPeldibXFMWkkydzRZOStLdTlFTjJhS2RxU0x0eExUVVVpblVTYUZ1S05SSmtYWXA2VDUxcmFMcHBFaTdRZHFlMFVtUmRvT1Y5bWltbC9XUlVxaVRRdDFRcUpNaTdWTFNmZXBhUmROSmtYYUR0RDJqa3lMdEJpdnQwVXd2NnlPbFVDZUZ1cUZRSjBYYXBhVDcxTFdLcHBNaTdRWnBlMFluUmRvTlZ0cWptVjdXUjBxaFRncDFRNkZPaXJSTFNmZXBheFZOSjBYYURkTDJqRTZLdEJ1c3RFY3p2YXlQbEVLZEZPcUdRcDBVYVplUzdsUFhLcHBPaXJRYnBPMFpuUlJwTjFocGorYVF5L3FCc2tVN3o3QkIrNFlwemF4bzltbjJucVkwc3pQU25lcFNVL3BmQS9SQnNrVTd6N0JCKzRZcHpheG85bW4ybnFZMHN6UFNuZXBTVS9wZkEvUkJza1U3ejdCQis0WXB6YXhvOW1uMm5xWTBzelBTbmVwU1UvcGZBL1JCc2tVN3o3QkIrNFlwemF4bzltbjJucVkwc3pQU25lcFNVL3BmQS9SQnNrVTd6N0JCKzRZcHpheG85bW4ybnFZMHN6UFNuZXBTVStwZm8rUFBvRWk3QnQwWUNuVm5LSnB1bUhMR3JMcEhzNkdiZmtFZjlBeUt0R3ZRamFGUWQ0YWk2WVlwWjh5cWV6UWJ1dWtYOUVIUG9FaTdCdDBZQ25WbktKcHVtSExHckxwSHM2R2Jma0VmOUF5S3RHdlFqYUZRZDRhaTZZWXBaOHlxZXpRYnV1a1g5RUhQb0VpN0J0MFlDblZuS0pwdW1ITEdyTHBIczZHYmZrRWYxTGlDNWh2RkdkM01sSFJXWGFwSXU4RktlOHZ1V1ptaTJTTnM2S1pmMEFjMXJxRDVSbkZHTnpNbG5WV1hLdEp1c05MZXNudFdwbWoyQ0J1NjZSZjBRWTByYUw1Um5OSE5URWxuMWFXS3RCdXN0TGZzbnBVcG1qM0NobTc2QlgxUTR3cWFieFJuZEROVDBsbDFxU0x0Qml2dExidG5aWXBtajdDaG0zNUJIOVM0Z3VZYnhSbmR6SlIwVmwycVNMdkJTbnZMN2xtWm90a2piRmlhVG84MzNZb2k3VkxPMkRjenBaa1YyaWNmamZRYjFja1YydmxibW4xTGw5TkRUYmVpU0x1VU0vYk5UR2xtaGZiSlJ5UDlSblZ5aFhiK2xtYmYwdVgwVU5PdEtOSXU1WXg5TTFPYVdhRjk4dEZJdjFHZFhLR2R2NlhadDNRNVBkUjBLNHEwU3psajM4eVVabFpvbjN3MDBtOVVKMWRvNTI5cDlpMWRUZzgxM1lvaTdWTE8yRGN6cFprVjJpY2ZqZlFiMWNrVjJ2bGJtbjNUVWt2UHNDWGQyWFNwTGRyWktOTHVDTkxiYVNjMEs0VzZtU25OYk1wMG80NmZZVXU2cytsU1c3U3pVYVRkRWFTMzAwNW9WZ3AxTTFPYTJaVHBSaDAvdzVaMFo5T2x0bWhubzBpN0kwaHZwNTNRckJUcVpxWTBzeW5UalRwK2hpM3B6cVpMYmRIT1JwRjJSNURlVGp1aFdTblV6VXhwWmxPbUczWDhERnZTblUyWDJxS2RqU0x0amlDOW5YWkNzMUtvbTVuU3pLWk1OK3E0Rkdrbk5EdE0wV3pxYm5SalJaRjJZdmRzcTJnNnVSdmRHQXAxVXFTZG1KWmFLa1hhQ2MwT1V6U2J1aHZkV0ZHa25kZzkyeXFhVHU1R040WkNuUlJwSjZhbGxrcVJka0t6d3hUTnB1NUdOMVlVYVNkMno3YUtwcE83MFkyaFVDZEYyb2xwcWFWU3BKM1E3REJGczZtNzBZMFZSZHFKM2JPdG91bmtiblJqS05SSmtYWmlXbXFwRkdrbk5EdE0wV3pxYm5SalJaRjJZdmRzcTJnNnVSdmRHQXAxVXFTZG1KWmFLa1hhQ2MwT1V6U2J1aHZkV0ZHa25kZzkyeXFhVHU1R040WkNuUlJwSjZhbGxxWWVnZTVJb1M1VnBKM1FiS3RvT3BtaTJXR0Q5a21oN2dpRnV0U0c2YlFPcFI2QjdraWhMbFdrbmRCc3EyZzZtYUxaWVlQMlNhSHVDSVc2MUlicHRBNmxIb0h1U0tFdVZhU2QwR3lyYURxWm90bGhnL1pKb2U0SWhiclVodW0wRHFVZWdlNUlvUzVWcEozUWJLdG9PcG1pMldHRDlrbWg3Z2lGdXRTRzZiUU9wUjZCN2tpaExsV2tuZEJzcTJnNm1hTFpZWVAyU2FIdUNJVzYxSVp1ZWtMemtacWRtYko3dG5IR1NudExPdHQwcVMxSDdMd2x2WkYyUjlEY1B1UXJxdy9DN015VTNiT05NMWJhVzlMWnBrdHRPV0xuTGVtTnREdUM1dlloWDFsOUVHWm5wdXllYlp5eDB0NlN6alpkYXNzUk8yOUpiNlRkRVRTM0Qvbks2b013T3pObDkyempqSlgybG5TMjZWSmJqdGg1UzNvajdZNmd1WDNJVjFZZmhObVpLYnRuRzJlc3RMZWtzMDJYMm5MRXpsdlNHMmwzQk0zdGFhbWxVcWlUSzJpK1VUU2RYRUh6VXFoclRGbVpWU3RUMGxsMVVxVGRDdW5PdEJQVFVrdWxVQ2RYMEh5amFEcTVndWFsVU5lWXNqS3JWcWFrcytxa1NMc1YwcDFwSjZhbGxrcWhUcTZnK1ViUmRISUZ6VXVocmpGbFpWYXRURWxuMVVtUmRpdWtPOU5PVEVzdGxVS2RYRUh6amFMcDVBcWFsMEpkWThyS3JGcVprczZxa3lMdFZraDNwcDJZbGxvcWhUcTVndVliUmRQSkZUUXZoYnJHbEpWWnRUSWxuVlVuUmRxdGtPNU1PekV0MDZYcVVvVzZtYUxwZHJ0Q005L01DdTJUUXQzTTNlaUdGR2szbzVsdlpzVjBPajJrTGxXb215bWFicmNyTlBQTnJOQStLZFROM0kxdVNKRjJNNXI1WmxaTXA5TkQ2bEtGdXBtaTZYYTdRalBmekFydGswTGR6TjNvaGhScE42T1piMmJGZERvOXBDNVZxSnNwbW02M0t6VHp6YXpRUGluVXpkeU5ia2lSZGpPYStXWldUS2ZUUStwU2hicVpvdWwydTBJejM4d0s3Wk5DM2N6ZDZJWVVhVGVqbVc5bXhYUmFoMUtQNEl3N3UyK3M3RXRiZFRJbG5WVjNoRUpkbzFBblY5QzgzTTEwbzQ2bkhzRVpkM2JmV05tWHR1cGtTanFyN2dpRnVrYWhUcTZnZWJtYjZVWWRUejJDTSs3c3ZyR3lMMjNWeVpSMFZ0MFJDbldOUXAxY1FmTnlOOU9OT3A1NkJHZmMyWDFqWlYvYXFwTXA2YXk2SXhUcUdvVTZ1WUxtNVc2bUczVTg5UWpPdUxQN3hzcSt0RlVuVTlKWmRVY28xRFVLZFhJRnpjdmQ3Tjg0SWYweDZsWVU2bEpUTkN0bnFKVmlkeWVhMlJuTnptYTJRWGRucGpTejRwdy9pUmZTRDFlM29sQ1htcUpaT1VPdEZMczcwY3pPYUhZMnN3MjZPek9sbVJYbi9FbThrSDY0dWhXRnV0UVV6Y29aYXFYWTNZbG1ka2F6czVsdDBOMlpLYzJzT09kUDRvWDB3OVd0S05TbHBtaFd6bEFyeGU1T05MTXptcDNOYklQdXpreHBac1U1ZnhJdnBCK3Via1doTGpWRnMzS0dXaWwyZDZLWm5kSHNiR1liZEhkbVNqTXJscVoxdkhHRmRqNGh2Ykc3bTZGNUtkU2xub1Z1cHphays5VE5GR2tucXRuWGYwYm9VT01LN1h4Q2VtTjNOMFB6VXFoTFBRdmRUbTFJOTZtYktkSk9WTE92LzR6UW9jWVYydm1FOU1idWJvYm1wVkNYZWhhNm5kcVE3bE0zVTZTZHFHWmYveG1oUTQwcnRQTUo2WTNkM1F6TlM2RXU5U3gwTzdVaDNhZHVwa2c3VWMyKy9qTkNoeHBYYU9jVDBodTd1eG1hbDBKZDZsbm9kbXBEdWsvZFRKRjJvcHA5L2VkUHFKWmlWZ3AxTTFQU1dYVlNOTjFNb1c2M1FwMXMwVTRwbXU2ZWlyUVQwN0phaWxrcDFNMU1TV2ZWU2RGME00VzYzUXAxc2tVN3BXaTZleXJTVGt6TGFpbG1wVkEzTXlXZFZTZEYwODBVNm5ZcjFNa1c3WlNpNmU2cFNEc3hMYXVsbUpWQzNjeVVkRmFkRkUwM1U2amJyVkFuVzdSVGlxYTdweUx0eExTc2xtSldDblV6VTlKWmRWSTAzVXloYnJkQ25XelJUaW1hN3A2S3RCUDkzOElkU1g5NDB6VUtkY09VWmxab1g2cFFOeFJwMTZBYnNrVTdVMFhhaWYxL2lpZVMvdkNtYXhUcWhpbk5yTkMrVktGdUtOS3VRVGRraTNhbWlyUVQrLzhVVHlUOTRVM1hLTlFOVTVwWm9YMnBRdDFRcEYyRGJzZ1c3VXdWYVNmMi95bWVTUHJEbTY1UnFCdW1OTE5DKzFLRnVxRkl1d2Jka0MzYW1TclNUdXovVXp5UjlJYzNYYU5RTjB4cFpvWDJwUXAxUTVGMkRib2hXN1F6VmFTZG1KYS8rYzF2SHNhLy8vM3ZyMS8xMytpSHArNUdOMVpNU1dkM2Q2S1pIV2hlaXFhVEl1MEdLKzB0emF5WVR1dlF2ZnptbTI5ZXYrcS9VWnU2RzkxWU1TV2QzZDJKWm5hZ2VTbWFUb3EwRzZ5MHR6U3pZanF0US9meWV0UnZwTE83TzlITURqUXZSZE5Ka1hhRGxmYVdabFpNcDNYb1hsNlArbzEwZG5jbm10bUI1cVZvT2luU2JyRFMzdExNaXVtMER0M0w2MUcva2M3dTdrUXpPOUM4RkUwblJkb05WdHBibWxuQjZlKy8vNTZIdnZqaWl4KysvUExMUS8zODg4OS9jbmYycU1YdDdFeWhUb3EwYTlsOVovZStHYm9qVSs0MU8wTTdVMFhhaVdtcHBkOTk5OTNydjNvY1gzMzExVS91WG8vNmpkMTNkdStib1RzeTVWNnpNN1F6VmFTZG1KWmFlajNxSHhWcDE3TDd6dTU5TTNSSHB0eHJkb1oycG9xMEU5TlNTNjlIL2FNaTdWcDIzOW05YjRidXlKUjd6YzdRemxTUmRtSmFhdW4xcUg5VXBGM0w3anU3OTgzUUhabHlyOWtaMnBrcTBrNnduUDBYWlhyVWYvakRIL2hmZUNYcWZ5bjJ1OS85N2lkM3IwZjl4dTQ3dS9mTjBCMlpjcS9aR2RxWkt0Sk9URXN0MWFQKzdMUFAyQ1orL2ZYWHIxdmVXUGxQNnR0dUtIWjNEYm94VE5Ic2JvVTYyYUtkVWpUZG85a3duZGFoNjFIMzZNWXdSYk83RmVwa2kzWkswWFNQWnNOMFdvZXVSOTJqRzhNVXplNVdxSk10MmlsRjB6MmFEZE5wSGJvZWRZOXVERk0wdTF1aFRyWm9weFJOOTJnMlRLZDE2SHJVUGJveFROSHNib1U2MmFLZFVqVGRvOWt3bmRhaFozalVVdHlybTVIT3EwdmRqVzdNYk5DKzNhWm85Z2dicHRNNmREM3F2cHVSenF0TDNZMXV6R3pRdnQybWFQWUlHNmJUT25ROTZyNmJrYzZyUzkyTmJzeHMwTDdkcG1qMkNCdW0wenAwUGVxK201SE9xMHZkalc3TWJOQyszYVpvOWdnYnB0TTZkRDNxdnB1UnpxdEwzWTF1ekd6UXZ0Mm1hUFlJRzZiVE92U1JIdldqMFh5M1pxVkl1eGJka1krRXZtL21Jekg5R24zNDlhaVBvL2x1elVxUmRpMjZJeDhKZmQvTVIyTDZOZnJ3NjFFZlIvUGRtcFVpN1ZwMFJ6NFMrcjZaajhUMGEvVGgxNk0ranVhN05TdEYyclhvam53azlIMHpING5wMStqRDlhaC85YXRmL2VmL1Yrdzkvdm5QZjM3ZDhzYjFxTmUvVzdOU3BGMkw3c2hIUXQ4Mzg1R1lmbzArWEk5Nk4wYzg2dFFVelVxaGJpalVwYVkwczBMN2hrS2RmQWIwM2J0Tm1aWmFlajNxSDlHc0ZPcUdRbDFxU2pNcnRHOG8xTWxuUU4rOTI1UnBxYVhYby80UnpVcWhiaWpVcGFZMHMwTDdoa0tkZkFiMDNidE5tWlphZWozcUg5R3NGT3FHUWwxcVNqTXJ0RzhvMU1sblFOKzkyeFNXcy8rUHNqLzk2VTgvZlB2dHQ0ZjY2MS8vK2lkM3IwZTlia296SzdSdktOVEpaMERmdmR1VWFhbWw5M0xsVVRkbzMyNVhTT2ZWU2JHN2EwbnZxR3M4QXQxSmJaaE82OUM5dkI3MXArZlZTYkc3YTBudnFHczhBdDFKYlpoTzY5Qzl2QjcxcCtmVlNiRzdhMG52cUdzOEF0MUpiWmhPNjlDOXZCNzFwK2ZWU2JHN2EwbnZxR3M4QXQxSmJaaE82OUM5dkI3MXArZlZTYkc3YTBudnFHczhBdDFKYlRqbTExeGNYTnlONjFGZlhId3dya2Q5Y2ZIQnVCNzF4Y1VINDNyVUZ4Y2ZpaDkrK0QvZFV0cFNEeDRFMWdBQUFBQkpSVTVFcmtKZ2dnXHUwMDNkXHUwMDNkIl0~WyJXQ3d5bl9pM3ZkV1BGYlFoMjh2T2JRIiwicmVzdHJpY3Rpb25zQSIsIjAxLjAyIl0~WyJiblNaWU5qTUpCeGpoM29pSDRnOS1RIiwicmVzdHJpY3Rpb25zQiIsIjA1LjA4Il0~WyJfU2dEVE5UZHJyVm1pa3J3Y2d3NkFBIiwiY2F0ZWdvcnlSZXN0cmljdGlvbnMiLCIwMSJd~WyJlSENyVFZwUUZOaHFINEg3amM5M0VnIiwiZGF0ZU9mQmlydGgiLCIyMS4xMC4yMDAyIl0~WyJ2TlUwenA5RDU3NlBScHpnVmZNRFJ3IiwiY2F0ZWdvcnlDb2RlIiwiQiJd~WyIxLUhQOVNxMnJrcFVzV2d4MEpGMUV3IiwicGhvdG9JbWFnZSIsImlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFRQUFBQUVBQ0FZQUFBQmNjcWhtQUFBWmpVbEVRVlI0QWV5VzJ3cUZNQXdFL2Y5L0x2b2s4V0Zsd1NYV3l3eVVrNmJwaFlKenVxd0E4RnNRQU1CTUVBQ01NVGdySUFBQWVMZ0ErR2V1ZkRBdStoV3I4YjJkNXZSOEZmdTV1dDZjMWEzcmMrRWRWUHdxRUFBQzBCK1hyKzNQM2JKL0VkMkJpSE1RQUJKbzZCdGhCTEk0dG91dkFuOGVYMi9YcU9idkJ3RWdnTGtDRUwvNWVPTUxRTlNuYzd2MzRnWHdVUUZzN05uTEVZSkFGRVRSL0hNVHRDd0xBWWVmZ01Qd01ZVm5QU1BRZGQvRkNhSHZwdGY5RGVCSGNkM3RXcmQyS21xbkVnQUFhVHVzYUhvZlBnRUExRlQ5NktNbkFHcUE5am43NEFtQUdtQ1lGOHZ1RHdLZ0JwaVd6Zkx5TzM0Q29BU0lhYmRMMWZqUWxRSUFZRmtQdTRYT1I2NFdBSUM3cit3R0g3aGFBQUNFWWZKeHF3VUFRRGRGeTRwYUxRQUF4cGdzOTd1UEFBQmFYbW16Y3huK0dqOEJBRDd0bmZsM1UrZVp4LytSSVUzYk5KM3B6QWtua3lZa3BLR2RKTk9rblNRVEVteThZY0FyeHVCOWt5ekxzdVJWWG1UTHNtU0JNYllsTDJDekdFUEFVSUlwRU5LRVBUUWtoQ1RzdTluRXpQeEVuOUZyenVWY1luRmxvWHQxNzlYOTZwelBzYkZKazByNmZ2Uyt6L3MrN3h0ZERUNFFnUFlBYVBEaEt2NFFnS1lBNERTL3dTZDBJSUR5MWk1VkFzQktTMHM0NFdkQUFHVXRxMVFIQUN1cld5a210eHdDMEpvQUFNaXZiNmVGK1JXMElFY1BBV2hKQUFBVU5ib292ckNTaFI4QzBKSUFBQ2oyaDM5UmFSVUxQZ1NnSlFFQVVOcnNwcFR5V2haNkNFQnJBZ0FnbzlMS0FnOEJhRTBBQUdTYlcxakZId0tBQUlEV3lLMjEwOEk4QXdzN0JBQUJBQzFSYU8yZ3VBSWpDem9FQUFFQXJWWDhFNHROTE9RUUFBUUF0RVJKVXljdDBWV3pnRU1BRUFEUUdtbkdlaFp1Q0FBQ0FGb2p5OVRNZ2cwQlFBQmFCQTArc1hrR0NBQUMwQjVvOEhGUTNNTUdId2dBQXRBYWFQQkpLT1FxL2hBQUJBQTBWZkZQTGpXek1FTUFFQURRV29OUHFvRnI4SUVBSUFDZ0tUSk5qU3pFRUFBRUFMUkd0c1hHR253Z0FBZ0FhTExCaDZ2NFF3QVFBTkJTZzQrVDRya0dId2dBQWdEYWF2QkpLcWxpd1lVQUlBQ3RnZVcrcFhxdXdRY0NnQUNBcGtnM05yREFScWNBSUFCUWJ1c2tZNnVMTEcwZFZOZnVvRVpITzdVNjI4anR0TklxWnowNUhZM1UwbTZqZW5zYldWb2RtbnB1bGxkeERUNHFGUUFFQUNyOTRXN3BzTk5xZHdzTmR6ZlFYenpWOU1XUWliNFpLYWZMbTB2cDJtZ0pYZDlTUWplMkZOTk5QNU4rYm8wVjBaM0JKWFRIRTArMy9VeDZFdWhtWHlMZDhITzFieEZkNlV1bXMzMXBkS0puQlgyNnVvVFd1VXpVNTZxaGRrY1RHV3l1cUhqZWNtcTRCaC9WQ0FBQ0FPNnBUL0ZWL3JEdjhsam9xL1VWVXdHZlpJRWVLeVRmMWtLNnYyMW0rSWFTNmI1MzRZencrYm5uamFOYmZsRmM5Y3ZoVkU4V2JWdFZUdDNPT3FwdVU5K29vYURld1IzcHBXd0JRQURBWU91a2RtY3I3ZlFIL3JzTmV2WXA3Zzk3a1hEWVJST0FzQlR1ZXVMcFJsOFNuZW5OcEMyckRHUjNOS3Vqd2FlSWEvQ0JBQ0FBQmFKcmNWT1R3MDViZTJ2cDlFZzUzUklPZkFRRklDd0VOa0w0dG5jWmpiaE5yS2FneUlyLzRqSUxDeWdFQUFFb2p3cGJKNjFaMVV3bmh3MXNyaTRRZXVVSmdBK2JMdHp3Sk5FWDNYbms2ckFxcU1HbmpvVVRBb0FBbEJmOHZ0V05kR3JFd0liMy9LQ3FVZ0Q4VWNGdFQ4SlVNYkhUSWE4SWxuRU5QaEFBQktDa29mNUFsNVZWN1BuQmp4b0I4T0ZFME43ZUZQSG5lUVhYNEFNQlFBQktnYTNISDFsWFNYZjV3L3dvRmdESExVOGk3ZWtxSVhPRTloemsxVDI2c3g4Q2dBQ1VNZHdmNmE1bmEvUmNHRFVsQUc1cWNLNHZqZFk2YXlWdjhFbmc3dXlIQUNBQXViRTYydW40K2dydVUxK3pBdUJQQ3o3ckx2UkwwU1hObmYwbFpoWkdDQUFDa0IrMmVlZjhwakl1Z0JBQWJ6VHdUVThXMWJYWlJXN3dxV0ZCaEFBZ0FQa0xmVU5yckd3N0xoYytDQ0NBQkM3MHBWQ0hvMUdrTy91NUJoOElBQUtRRWIwLy9EczkxVUVxL0JBQXgzVlBNdlc1cXNOczhHbGhBWVFBSUFENXUvQjIrY04vYjhiemZRaUFNZWxKb29GT3kxTTIrTFN4Qmg4SUFBS1EvNU4vVzI5TmlNVStDSUJqMHB0RVBhN1FWZ2dLR2h6Y2tWNXlBZ0ZBQUc3YXRMWXVqUEJEQU54MHdOM1JFT3FkL2ZJQ0FVQUFnMnVzM0p3ZkFoQkJBZzMydHVBTlBqcUwvS0dIQUNDQTFvNDIxcDh2VWtnaEFNWjN2Y3ZJMU9wOFlvTlBXa1c5L0lHSEFDQUFVNnVMdGU2S0hGUUl3T2RuZDFmcEV4cDhtbGpZSUFBSVFQNjEvZ212V1lMMlhRaUFjZGNiVDE1WHplTU5QdFd0ck1FSEFvQUE1S2R2ZFpPRVJUOElnSEhOczVnZFdzbzErTXp3em40STRNR0RCd3dJUU1xaC85bE5Pb2tEQ3dINC9PeGJVMFJGd2cwK0VJQnc4Q0VBc1dIci9UN0pBd3NCTU81NEU4aFVGV3pZRHdFSUJWOVFBSncxT0NDQTROMTkxMGVMNlQ0RUVER091Rk1vSmtjSEFZUXVBV0VCaEI1NENPRGdvQ25Dd1lVQTdua1dVbjFWSGdRUWV2Z2hBREZwY3JUVDdiRWlDRUFHdmw2OUJBSVF2d2FBS1VBbzdPMDN5eFJlQ0lDTkFxb3FDeUNBMEVXQUVZQVkxTmc3Wk96dmh3QVlYN3BTSUlEUUh4Q0FHSXoxMU1vY1lBamdyamVPZElZaUNFRE1FUUNtQURQcjh6KzNxUXdDVUFCanRtVVFBUFlCUkJhSHExVWhXMzRoZ01zOWl5Z3VWNUlsUWV3RGdBQUNNK0ZWU3ZFUEF2RDVzVWhURE1RK0FFd0JBdC9VZTNGektRU2dJTWJiTWlBQTRTeERBR0xoY3RrVU52eUhBSzcxSmRGQzRXa0FhZ0FRZ0Rpd0UzNlZGV1FJd09mSFVGRUVBUWlMQURVQUVXQ1hlRUlBQ3FTbklSc0N3SGtBMG1KdWN5cDA2eThFY0xoVHRFMUJHQUVFSHY1REFLdmRMUW9OTXdSdzA1TkE4WGs2Q0FBMUFPbGdsM3hBQU1xdEEraWwzQldJVlFBSTRQaDZJd1NnWUp3MU9SQ0FZSDVSQkF3RE4xM2NYQVlCS0pnTnpjc2dBSDc0VVFRVUQwdWJrOTN4QndFb21PT3Jsa0lBNHZVQ1lBckFwOFBWcXV4QVF3QnNReEFFZ0ZPQnBXR3d5d29CS0w4UUtOSktBSnFCTUFLWWR2SnZMUVNnQWdyMHhSQkF1QWVDUUFEVDJkZGZCUUdvZ0JwVEFRUUFBWWpQMFhWR0NFQUZkTlRrUWdBQ2gvdXdyMWdHREIyVlhQb0pBWFRYcjRBQTBBc2dQdW80QXdBQzhOUm5RUURCUDh6UkN4QXFWMVZ4NXo4RU1HUmRCZ0VFMzlXTHJjQ2hjbk5MTVFTZ0FrWmJNaUFBQ0VCODdxaWlEUmdDMk5tV0RnRUlqK1pSQkF3VmZZdGJKY2VBUVFCN0hXa1FBSXFBRUlCV0JiQy9JN2dBVUFURTNZQWhjd3RUQUZXd28xV0VLUUJxQUJnQllCVkFuYXh2eklRQUlBRHhPYStLcThBZ2dMNEc3QU1JU3dDWUFnVG16QVk5QktBQ2V1cXpJWURwZVVZUk1GeE9EUnNnQUJYUVZZZXR3RE45b0IyWWdXWWduQXVva1dZZ2RBT0d3ZDUrTXdTZ0FzeVZhQWNPOUlBQXdtUzR1d0VDVURnK1AybEZwUkRBOUVmMFh3MkdTMEVnZ0Z1ZUJINEFNUVZBRVZBOEdoM3RFSURDK2FGN01RUVFhaEdRc3dXV0FZV3BzSFVxdkNFSUF2aXNJeFVDd0RJZ05nTnBWUUQ5MWl3SVFMaWVoNTJBNGZERmtBa0NVRERONWp3SUFBS1FqblZyb21JbDRCOGNmZ0g4d3g4Y0JxbWRlOTQ0eWlnT3RBSUFBWVRjRFFnQkJNYldZVmQvK0FPUEFGUXZnWE5yazRVRGlTSWdlZ0hDcGJ5bGszVUZxbDhBL0JFQUp3Q2NCQlNWeTRDNEdneFhoQWNXUUpTTkFCdzFPUkJBWUJHZ0YwQk1SbnRxTVFKUTRBN0EzTEppQ0VCWUFOZ0tMQWF0VHJ2Q3JnbEhEZUJzZDdqemYwd0JJSUFRemdmOGZxTWVxd0FLWWwxVEZnUVEvSUZlQUxIWTBWZURmUUFLR3Y3ckRFVVFnRUFoWHpORlFFd0RlSFA4d0QvaklONElnSVA4Q1B5Wm9jemx2NWdjSFFRd1hRVG9CcFJ5R3ZERFJwM2lpM3dDVXVBRVFGelFoYjRxbVpIbUNBLy9jVE1RQk1BWTc2dFd2Z0FZb1F1QVFXb1lBZHp6VTE1UkNBR0UwQXdFQVloRWs2TmRnZDJCMHovMXd4d0I4RkdjQUU1M0xhYllYQ21ILzlnSnlBRUJUTVBOemdtTXhob0FxYVVHNEs2VmFmTVAyb0VoQU1hYVZjMHlYUm1HVllCcnZZbVVuRjhHQVlqZERSaThpd2dDNEREWU91bXNBb3VCQW5VQUNyWVJTQzNGdjdGVzBXOEFnZ0JDbWZ0REFOelc0RHBWN1BxTEpnSGM5Y1JSa1Q3a3JiOW9CNFlBeE1mYzVxU2JXNHJWdENUSTN3azRrL1YvVWhvSFJEajZDMFZBVEFGRVk2ZFNsd1NGVndlSUx3RGhyOHI2OURjR1hmcURBTEFUTUlMVTJEdllPUUhLcndFSUM0Q2hlQUY4N3VJKy9TR0FVR1NBZG1DSjJkWmJnMVVBaWJuamlTTzlvUkFDd00xQXlzTmk3NkRMbTBzaEFBblo3MHhqd1lJQUlBQ3NDR2hOQUhjODhWUmFYZ1FCb0IxWXVaaGFYUkkxQ1VFQXUreGlyUHVqQ01pK29nZ29JV3RYTll2Y0l3QUJYT3BKb3ZTSVh2cUpFUUNXQWNOb0ZmNWkwQVFCaU1ROWp3eDMvcU1iRUNPQWNMQzJ0NHUwTEFnQkhPbE1vZmc4SFFTQW00SFV4YWExZFdFMkNrRUFrMzBKRVM3OFFRQ1lBb2lFMGRaSko0Y05FRUFZWi8ydGIxb3VRaEFoQUxRRHkwUnpoNTJ1YkM2QkFKNkNJKzRVV3BSZkJnRmdHVkRkZUxzYVExd1ZnQUJZMVg5bGFZbDRZY1F5SU00RWxITlZZS0xmREFHRXNOMjN4U0wyTmQ4WUFVQUFNbThRK25ha0hBS1l3YngvMUxhTUh5SUlBQUtJRHRxY2JYVHh5YjBDRUlCbklSMTFwMUJpbmdUemZrd0JVQU5RQXF2ZExkemhJUkJBZ0JOKzA2VGQ3WWNpSUZZQjVHZHdqWlZ1UDFZVWhBQXU5aVJSc1Y2RzlYN3NCQlJlUDRRQXhFZlg0cWF0dmJWMGR5c0V3TGpSbDBBMXBvS29Dejl1Qm9JQUJFOFQzdHR2WmhMUXRBQnU5Y1dUVGY2S1B3UUFBY2l6VTNDQ2s0QUdCVERwU2FBT3ladDhNQVVnSWhRQmxVcUZYd0tmZWkzazIxcWdLUUhjN0V1ZzlwcmM0Q0dDQUZBRTFJSUVyZ3l2WkJMUWhnRDY0Mm1Eb203MFJSR1EvUVUwQThuSWo3MnA1QnRKcC90TUFsRXRnTGdwQWJoclpHanlRVGNnUmdCSzVZZWVsSWNCV2UvL09wWVhsUUpnd1dldzd6dXJJUUFJQUFKNHhQZWNBQmorVVBxMjVFU1hBQVlTMktjLzkyZS9BTEloQUlXMkE4dXlDZ0FCcEQ2K0ozNGdrWHlicy8waExWQzlBSHdEQ2ROKzVvSUFsSDgxR0VZQWtlUE0ydFRBOCtVTkdmNjZRTDdxQk9CajhJYjhQOFVKQVVSOEgwQklJd0FzQTBhTzRxWk8rcVpyeVpNRHhVSTZ5cTBTcUVRQTdGTy9ueHZ5UXdDS0hBRmdDaUEvSmMxdVNpbXZwWk9keVVFTGFHeVZ3RGVXcjJnQjhENzFCZW13UUFDSzdRWGdIaGdCU0V1cFAveVpsZGFwTjhwWG5BQ0NNQlhZVGN2WnRFQmhBb2pqRi9xQzRvQUE1TjBLakJHQS9HUmJXaWdtdDN6cWpYSkNXQUNCcHdXYk9SSElLUUMycnAvQWZlclBtSFlJUUQ0Qm9BWWdQN20xZG9yTk16eDZveHpuQ3lCa0VXU1RiMnJ2UUVGRUJPRGpiZWpoei9NaEFFWDNBbUFWUUNrVU5IUlFmR0hsWTIrVVk2N2tNSXR1U1hSL0pKMFZDOW1vUUhRQjhFUHZDeVA0SEhiekNnZ0F2UURhRTBCUm80c1dsVlJOZTZNY2RTMFdxUWdYNXcvMUlycS9JWlBKNE9ISVlHdEJlQUxvanhjdTdrRUF5aThDWWdRZ1B5Vk5uYlJFVnozdFRSS1RWMGFIM1lza1dvNUxmTGl6Y0NUdFljMWd5MG8vdVg0eDVFNXRPZVlMd0RjVjlvZHplbDgvYjRqdkVmKy9xN1UrQXdJSURtb0EwVlR4VHpmV1QzdURMQ3dxcHJ5aCtmVFhqUjlFY0U5KzNNTlA5SUdIeFRzdTZGTUNpQkNtMFpjb3VUbVdGdVNXUVFBQ1lCVWdTc0tmVmRYMHFPTFBrV2pNSWQydXQ2bjZxNWRwMis2M1dUQTB3UjF2RE9XT1Awdkx4bWRSU3RmYkZGT294TE1BSVFDTUFFUWlwNlp0cXVMUEgvS24yVkxJOUxmWHA4TFBjQnlhUzVPREN6UWhnSW1OYi9yRC8wK1B5QmgraVJMTmFmN25SZ2NCeUZrRHdBaEFmUExySEJTWFgvSG9EUkZYWEVUNTZ6OGs4OUU1VThIbmMyRDd1MUVmL3NuK0JXUVkveFVML3VOODhrdEtib21obUh3UnJ3T0RBTkFMSUNlRlZpY2xGcHNldmhseWRaUml6YUR5VDk5a1lRK0k3Y2lyZEdIOVIxRXRnS0d4VjduUUIyQVdwZmZQcFhpRERHY0Y0RzVBckFLSVhmRmZYR2FaR3RiR2xSVlE3c0RIM0tlK0lBUDdmMDkzK21Pak12d25odjlNSzhhZllXRVhKSFBMODFNRndsaFJhd01ZQWVCQWtBZ1cvVklOZFZNVi9reG5NaG4zeitNQ0hwd1RMOVBFK0R0MHp4dGRFcmc2OEJIcHhwOWpBWjhoc3loajVFVktOS2RLUHkyQUFEQUNFRFA4eTZ2cktNTytsUFM3M3lMTENSYnMwR2c0OWdxZEhIMC9hc0ovdXorR2JKKzh3SUlkT2p1ZW9iVCsxeWpSa2hMbWtpR21BS2dCU0UxYkI1VjBsNUp1L0U5YzhKK2F0c092MHJuaCthb1AvMTF2TEEwSXp2dERFRUh2UEVvd3BkT0N2RklJSVBRSDlnRkloczFGK3E1cU1rM01KL014YnA0ZlBsMmYvNDRtQjJKVUxZQTlHOStrN1BGWkxNU2lrTFg5NTVTNjlnKzBzQ3hING1WRENBQWpnS0M0U2UrdXA4cnR5V1E1T3BlRlZuUTJUYnhKZDFWYUR6aTUvcytVTi80c0M2NzRiSHVPbHJyZW85aWlRZ2hBSUwvWUJ5QVZkanRWakt3a3krRTNXRkFsWmYvMmQxVlhGRHcvOUNHWnR2K2FoVlZTTWplK1FJdXNpUkVxRkdJZkFBUmc2NlR5WGlPWjlyM0h3aGtSck1mbTBOODN2eCt0UlQ5UjZnUHAzdGNwM3BnRkFlQlVZT25RZGJSUTVkYWxaRG5PemZNalI5dWgxK2o4OEh4VkZQMEd1YUpmcE5uNkhDMjJmMFF4QmNVUUFNNERFUGxUdjYrY3FnNit3OElvR3oyZnZVRTNGTjR2c0djVHIrZ25DN01vZlhBT3hWZG1RZ0FRZ0FpMDI4bTRKVTJHVDMyQm9xQkNkd3ArTmN3citzbE1wbjgwa053U1N6RjVwUkFBQlBDVUZmNVZkV1NhK0pBRlR6SFVuSGlaOXUxUVhsSHd3dUNIVkRIK3ZCeGhGOTQ3MFBNZklXNHBoZ0FnQURiazkrakovT1VmV09nVWgxVmhPd1ZaMGE5VnhLS2YrQ3NGc3ltdWZBVUVBQUhNYkZPUGNVTTJ0NjZ2V05vT3YwWVhodWNyb3VqbkhadkRncVpvc3JZK1Q0blZTd1UyRDBFQUVJRGQvbkJUei9GWEZCMStmbEh3cHN4RndRbCswVS9wYkgrV2x0Zy9tdDVUQUFGQUFEcUhqVXk3WTFpd1ZNV29qRVhCazd5aW4zcVlSU211OXg3MkUwQUFFQUMzdm0vYU0xOTE0V2ZVK291QysvMUZRWjgzRmtXL0VDU1F1dWFQYklVQUF0QzZBSFRPWmpMdC9XOVZocDlmRkR5MStZT0lIdXJaK3Nsc0xsQ3FsVURhMnJkb1FWNFpCS0JWQWVnNmJQN3dmOEJDcEhyc2gxNWp4NGxGcE9nM05QWWFDMUZVa0xyNkhUWWRnQUEwSndDN2cweTdGN0R3UkEyOW44Mmptd1BTRmdVblFtL3ZWWDVOb1BNOVZoaUVBRFFqQUp1TEtuY2tzZEJFSFZ2MnZDVlorL0RmaC8rTDhzVXYraWxpdzlCaVd5eGJJb3grQVVBQW5XUWN6U1JMRklhZjJ5bDRZTHY0UmNIckF4OVQrWTVmUlYzNGVVdUViSjlBdEFzQUFqQjQ5V1E1OWlvTFM5VFNlR3dPZmJOSnZLTGdiVzhNdFhGRnZ5Z21hK3V2S1U2L01sb0ZBQUhvT3Exa1B2VDdxQTQvdnloNFVZU2k0RDMrbVg0YUlHTm9EbHNlakRvQlFBRDJkbTY1VHpQMGlWQVUzTHZ4TGE3b3B4bFNWNy9MNmdIUkl3QUl3RTNHMFhRV0NzMHh0dWV0cCs0Yy9Ibzl2K2luSGJMOHdrdXNTb3NXQVVBQSt0VzFaRGt5VjVNQ3FEMytNbjIyL1U4aEZ3VXY4bmY2YVpGTnM5bitBTlVMQUFLd3ViaWVmczNTZUhRT2ZidHg1a1hCTy95aW40WkpjYjZ2ZGdGQUFCWHJDbGdJTkUrN3Z5aDRhUVpGUVIrLzZLZHhzcmIvZ3VJTjJXb1ZBQVNnYzdTUytVdXU2Zzg4QitiUlpKQ2k0TUVOLzBsWmo0cCtJTTM3T2lzSXFsRUFFSUJ4ODdLZmhBQnMvZlRKUmNGVDA0cCtnTzBTVEt4S1Y1VUFJQUR1MC8vUVBJUStRUHZ3d1UrbUZ3VXZEYzRuWThDaUg4Z1llcFdOQXRRa0FBakFPSnFCd0FzVUJVK3pvaUN2NkdjWEtQcUJaeWlwT2xVMUFvQUE3SGF5SFA0ZHdoN2s5dUdyUXg5UFRRYzJqTTRORWdDUXNlNFZOZ3BRZ3dBZ2dJcmhuQm1FQVBRY2ZJUDJiWHlic3NlZkNSb0FNSXZpSzVaREFJb1hnSzJUcWc2OE80TUFBTlBSRjJubHJwOGgzS0VjSGdJQktGc0E1ZDBtaEhzR21JKy9SSGtUdnd3aEFDQnIyL05zZHlBRW9Gd0J1TW0wTXg0QkQ0TGx4RytwZVAvVFhOME5raHNUSUFERkNzQnVuOEdlZjRSZi83ZC9SWmpEYUJlR0FCUXFBSU5YRnlRQW9QTHdiRnErNjJsMytvR3NIYyt5dXdZaEFDVUt3TFFyRGlFWHdIVHMzMm5sN25CMytvRmtheElFb0RnQnREcURYT2FKb1gvK1g1OFRJUUFndGZ0TkNFQnBBdEN2TVNQb0F1RXZPZkRQQ0srSVp3ZXlUVUVRZ0VJRUlMejFGNVIvOFcrVUpXb0lRSUlwQXdKUWlnQ0tyRTR5N0E2MCtRZVlqcnhJeTNlS1hmUUQ3SlpoQ0VBQkFpaHA2cVFsK2lveWZmblQ1VDlRZGV3bHl2bjA1eElFQUtUMnpwTmJBQkJBYWJPYlVnMTFsRlFaYU84LzV2MEYrNlM2eUFOa2JmbU5uQUtBQUZqNE0wMk5VMDl5bWkwRm9mOUorTXNPL291RUFRQlo0eitqbVB3U09RUUFBYkR3cjdEWUtDYTNmT3BKemgzNG1CY0FVSEhvQmNxU2ZONFBraXlwY2dnQUFzaXZhNmZZUE1Pako3bHMvSSs4QUtEREwzdFhKTnA3d2VMV2p5TXRBQWlnc01GSjhRWEd4NTdreW9NNC9JUHI4TXZkODR0SUJRQUNjTDBiU1FGQUFNV05MbHBVVXZYWUV4eVRWMGJtWTY5UU5lYjlWTFEva21mNmdUVHYzRWdKQUFKZzgvNmwrcHBwVDNDOFBwK3FFWDdTZlI3cERqK1F1WEYySkFRQUFiRHdweHV0QVovZ1pNdHl6UXZBZUhnMmluNXlIUkFDQVVnckFCYis1VlhOVDN5Q1U1dlROTi9obC8wWHVZNzF3bElnNndtQUFDUVVRRzVORzFmeEQ4Z3k1eUlORi8xK0svT3hYaUMydUJBQ2tFb0FsNjdkSU5mUVptcnZIM2tpM2J1N2FQM0pKazB5Y0x5QnVqNDN5UWh3YnVnWGVuOCtiZkFoZ0N2WGI5S0oweit3SndFQUxRRUJYTDB4U1Y5L2YxWnJMellBRU1BMWYvaFBuNzJBRng4QXJRbUFoZi83ODVmd3dnT2dOUUd3OEorN2RKVU80MFVIUUhzQ3VIajFPaDA1OVIxZWRBQzBKb0RML29yL3NXL1A0QVVIUUdzQ3VPb1AvOGt6UCtMRkJrQnJBbUR6L2xNL25NY0xEWURXQk1EQ2YrYmNSYnpJQUdoTkFDejhQMTY4Z2hjWUFDMEs0TUtWYTZqNEE2QkZBVnkrZG9PT2ZvT0tQd0RhRUFBYWZBQ0FBTkRnQTRBR0JmQS8vL3QvVTl5NTU2UExOeVlCQUNFZ293RHdlUERnZ2VEUHcvdDk0RCt6N3dQOG5rUGdaNEgvK2VuZmgvN1A4bi9PLzMzby8wM0NQd3YzT2VDK3gwTjFBb0FBQk1JcThIZWwvMW1rL3YxRUpNcHpRRVNRQUFRZ3JnVEUvN093TU1LUUJaK25IaFVFK25lRStQZUQvbTl3Qkg5KzVCY0FCQUFCOEwrSzhYdkpSd0RCd2g2eWZLVDdkNmxtQkFBQlFBSmkvWjU5SDFZTlFPQjdqcWV1QVlRUWNvNHcveitKL3h6Z0FRSGc4U1NoSVNCNFFBQVFBQjU0L0Q4Sk05VnprMFFxc2dBQUFBQkpSVTVFcmtKZ2dnXHUwMDNkXHUwMDNkIl0~WyJrQ3VkNkNLQk9fWkd3N0ZseUNlRVJBIiwiZmlyc3ROYW1lIiwiU2VyYWluYSJd~WyItaGk4YktIX0loanlwNGJjN09mUWRBIiwiaXNzdWVyRW50aXR5RGF0ZSIsIjIwLjEwLjIwMjMiXQ~WyJvbkxwXzBGd2M3X1NTbC00cndkSWd3IiwiY3JlZGVudGlhbE51bWJlciIsIjI3MyJd~WyJYcG52YmtiRG1xcmpVWUJvUHFoLWh3IiwiZmFiZXJQaW4iLCIxMjM0NTY3ODkiXQ~WyI3aXVCazlVN29VbXVFYkpxekhqMld3IiwiZGF0ZU9mRXhwaXJhdGlvbiIsIjAxLjAzLjIwMjUiXQ~WyJTSnh0QlRZdTJ5UGZ3RC1ndXZrNXJnIiwicmVnaXN0cmF0aW9uTnVtYmVyIiwiMjMxNCJd~WyJGUGdQRlk0Vnp6QXg2RUcxaXJFY09BIiwic2lnbmF0dXJlSW1hZ2UiLCJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBU3dBQUFESUNBSUFBQURkdlVzQ0FBQUFBWE5TUjBJQXJzNGM2UUFBQUFSblFVMUJBQUN4and2OFlRVUFBQUFKY0VoWmN3QUFGaVVBQUJZbEFVbFNKUEFBQUFucVNVUkJWSGhlN2QxUmdxSTZFSVhoV1pjTGNqMnVwamZqWXVZRzVMWktLcVFxSVI1Ry91OXRab1RFcWh3RXBIdisvQVVnUlFnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0VFQkFqaElBWUlRVEVDQ0VnUmdnQk1VSUlpQkZDUUl3UUFtS0NFTjUvYnJmcjlYSzUvSG1UL3VKeXZkNXVQL2Y3OGtMZ0ZENFl3aFMrNnlwNFpaZHJTdU95NGJiNzIxNHZWK2Rtd0ZGOEpvUXBmKzc0dlVwUnJFVHE1N3E4OU9sUzJ3WTRsQStFOE40V3dNVjJwSXdNa2tMOFkwYUhzQytCQ1NIRXR4c2J3bElFTC9NbDMxdFU3dmY1aGszKyt1dlA4Z29MSWRSWVhWNVE4UzRqUTJoSHNOcXdsTWJyODlacDVlVmNFeXBrVmFmbVBRYUcwTXBnb0ZsVEZOTVdteCtFazNSUWZvNlRQbUs1T3pvZUlkelZ1QkFhR2FSVlg0SVE3bXBZQ01uZ0Z5T0V1eG9Xd3Z4aWpVWjlEVUs0SzBLSU9FSzRLMEtJT0VLNHF3K0dzSDZqVThaOHBueDZvSHg2bm54NXpSRHo4N1J2d3o0ZVk5L25LZmI3L1NmdGZ4cGdmWDArL2RVMFRPTzcrODRRdm44M3RpeUFUL3c4d1NkdnpJeEo0ZU9iakYrWFcyU1EwRVBsdHRMNlc3NWlXYXkvT25FTVhIOXd0aVQycmh4ZjY5amYrUG9VNi9PK3ovQzdmWDl3dnp6TzAxWkgzdi90emZnRHpMQVFXaCtGSTJMWWZsRGVxSHRJWWNEMXhKNXZQVEp3Y0FXMHY2ZXRnWG95V05wenZzL2cyb2czdnRpUjdmY1hiRUdEY1NHMFU3ajdXMm9NWWQrNmVsTVlzTkR5K01EdWl0a0Y5eXNPOU5VaHJMNDVkLzJiRFF4aGNWSHMrbFJMdkJkSmNibE9WMG9QMldWVVVXSHhXQzF2WE0ydVpWRFo5M1FWT0Z2K2JDb005TVVoTEs2RUoxZjF1NHdNNFZiejVrdmU1V1ZkNHIwd0MyOGZHTkxGbGZFT2x0VzhLRjJEWmkyL1pmdWFyOGFldzA2UHNCZk9KaDBMd1NoMitjWkNjYVRDUU9rczk5WHk0bGZMditRSzlUbEVDTmQvc3hSc010M1NlcnpSNEx3YURBMmh1VEpldlMvQ0p1RmVXSXQxYzVOc0JGOVhzczNlcGNWcEQycGYxdFZUK1BxK2ZJZTROTkx5K2hmMWdaSncwWE1IQ09IS251ZG5NWU5EbU5SdkZYUjlLa1o3a1hlaTN2eHN3WGpXeTBiTGE4dkZPblRWbC9tOFZiQ1d4a2llUE1VRGtEbFlDSFVKVE1hSE1ISGRzbXVNWXJBWFdlOTl5MmM5aW1PclVzdGRBemFHbzBFK1RVY1lna1czSENtRWcwcnI5cEVRSnQ1NzUrRW9CbnV4ZnJtei9nM1pOVnZ1YnJlUnd1QWlkY29IY3N3eEhvRE1jVUlZbi92ZVBoWENpZjg3NU9JRlV5N1dpNnoxM3M1bncxUTNORm9lV1daTjRXZ1JYOHh0MjZ3Y0pZU0RxaHJ5eVJETzVtZURsZ0pzY242UkVldUZNb1RCZHZkdTc1V1Z4REhPRG5NN1JnZ0gxVFRvNHlGOGNFWng5L1h3RDRXd2U1VTZuVG1FWXlvYUpncmhZb3BpSll1MTBzWjYwYkxpSmczYkVjSk5Sd2hoZk5aamFFUDRVTGxXM0M1VnNMTFp5MTJ0YjFreHZTM2ZNNFR6bDgvSmJYa2M2TTE2R01jOGQxak9oUERwQ0NHYzJRK25QR3dWSzFyWmxrNWsyM2dXVEcvTHUxZnBmR3dyMXJTc3BTREI5NVlRd3FmRGhIQ1dkMlpSYmxDNHN0a0dsZlpiejVWNDFrdHZ5OXRYcWY4dXRNa3h6eDJXTXlGOE9sWUlrMElPaXgxcXFHeTJTV0ovS1dMZlB2TDFycmZsYmF1MGVCanpjOHh6aCtWTUNKOE9GOExFRGttaFhrMlZ0VWFZT1g2S3d0dTUzcFkzckZMbmx6OFZqbm51c0p3SjRkTVJRMmdlemtzdGFxaHN0a21BZjZYMHRqeTZTcTJpUFZ3ZS8rdGo0Vkg1YkR2SFBIZFl6b1R3NlpBaHRHSlNLbGk0c3NhK25TNmhaZExiOHVBcU5kK1c1NEVIUWloM3pCRG1IU29XTEZqWjljdXY4OCtOTFg4b2N6Nis4NnEzNWFGVmFoUXN2ZHcxSGlHVU8xY0kxL3Y5N2Z2ajUybFgxNEhwengyLytPeVRJVFRxNVY3UzJiYU9lUTRKWVhBZmhIQ3dyRnpsUlJXcTdPckZ3V052VEcvTEl5SE02K1YvYTZJUWR1OGp2djBlc3g3aVg3a3hVNnhYcExLci9ZN3RRVy9MdTBJWUdLc2xoQzNickdWekRoMFQ4NjNyYytqdHlEQkhER0dvd0pIS1pxOGQrVkhZMi9KQUNQT1hCc2JhSllRTmxjejM0ZDZKc1dsU25mZkpRamhYcWZGSDVhMEtiMVFyVWxsejE5ZnVYM05qKzJBSTg3SGM2OW40YXRFeHozeHVEZXM1bjdScjFsWVRaOVVwbkN1RUwzV0svczRUb3pQYnhRcFZ0dGpBRi9PdkNQdmY4czM5L0J2amcySHRiWGtraE1iN2Nxem53bytUZWVhWnQ2bGhRVnU5cmt4N3E0SFZHZlIyWkpqUklYeElxN202aEl0UFBHNlhLbGhacS9FaG5yY3k2MjE1SklUeDlienh2THhubmxZWUhMRmZNWnRSSEg3OWUrL1hxdlB1N2Nnd253bmhyN1NFYjQ4UGxWOC8wMy9HVXE1dXJWRGh5aGFPL3pIcGJkVDY5OUVRMmlXM1QwTnF6M2U3NW1ubjUvWDR0SHpyRXo1MlRPYUpyL2EwL05PdjdQZTRWdWQ5cmhBV2l4dFdQN28yVmJaOGxJallubHh2eTJNaDNLcjU4NnphZWlEMmNsdDlLUHJtNlcveDV2NGFWOHIwSU1LNlFOVjU5M1prbURFaDNHV1ZwK1Bxc3JjdDhjcGFjMXN1QWFPVDNocXJ0K1hSRURZdDZIbE9xNUc4OC9RT1Y5bGZlTmJUNSsyMElTR3NxNTMxYkFuY3pnbFcxa2hncFJYektYUHhqTGtjak42V3gwTTQxZHhmOHVjWmRXTUl2Zm1wVGpzdzY5ZkxBRUxvWlovUGw3bnZlL3h2MWNIeS93MHh5VmZOY2xSMU1SZExzWkdoaVZuU1dlTGJEbHduQnRPNDFZTFBSVjVlUG5sYnp0NXhIbXAzU3p5SGprazlpT3RKcjZhZEdsRWJxTHNqbzR3TzRhLzVEc3pXL3hyN2VpaytSc3RueTBxK2kvZytQbUkrK0syZmhrMTFIdkpmRHh0anpVME50L1J4eXBGUGV2alMwUHBZQ1BXeWo4R20rQnoybkFiL3JQT0VjSjhNRWtMczdqUWh6RTRrMjhLend5a3Q4TzY4SWVSc0ZBZHg0dFBSaGhUbSt5Q0Q2SGFlRUJvM05rTVJpbjFCQWJpZEo0Um1DcFA1RHZqeUVsdnhtemNpaUQyY0tJVFcyZVNyK2F1dFY5TmZMUDltNFk0TTluR3FFQlkvRGNPeXB6ZUFaaWNMWVZKL1FLcUNBR0pmNXd2aHpQR0FaUzZkclg3NTgxT1FPR2tJZnoyZWFKMHYvNHhRVG4rYi92WDJ3MmNmeGpsN0NBRTVRZ2lJRVVKQWpCQUNZb1FRRUNPRWdCZ2hCTVFJSVNCR0NBRXhRZ2lJRVVKQWpCQUNZb1FRRUNPRWdCZ2hCTVFJSVNCR0NBRXhRZ2lJRVVKQWpCQUNZb1FRRUNPRWdCZ2hCTVFJSVNCR0NBRXhRZ2lJRVVKQWpCQUNZb1FRRUNPRWdCZ2hCTVFJSVNCR0NBRXhRZ2lJRVVKQWpCQUNZb1FRRUNPRWdCZ2hCTVFJSVNCR0NBRXhRZ2lJRVVKQWpCQUNZb1FRRUNPRWdCZ2hCTVFJSVNCR0NBRXhRZ2lJRVVKQWpCQUNZb1FRRUNPRWdCZ2hCS1QrL3YwUGZwS01SY0NEMXRFQUFBQUFTVVZPUks1Q1lJSVx1MDAzZCJd~";
    // TODO check what should be supported
    private final List<String> suggestedAlgorithms = List.of("ES256");

    @Override
    // follows https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt#section-8.1-4.3.2.4
    public ManagementEntity verifyPresentation() {

        Jwt<?, ?> jwt;
        var publicKey = loadPublicKey();

        // Separates SD-JWT into the Issuer-signed JWT and the Disclosures
        String[] parts = tokenString.split("~");
        var issuerSignedJWTToken = parts[0];

        Jws<Claims> claims = Jwts.parser()
                .verifyWith(publicKey)
                .build()
                .parseClaimsJws(issuerSignedJWTToken);

        // check signature
        try {
            jwt = parseAndValidateJWT(issuerSignedJWTToken, publicKey);

            // Checks if the presentation is expired and if it can already be used
            var header = jwt.getHeader();

            if (!suggestedAlgorithms.contains(header.getAlgorithm()) || !Objects.equals(header.getType(), "vc+sd-jwt")) {
                throw new Exception("Unsupported algorithm: " + header.getAlgorithm());
            }

            Claims payload = claims.getPayload();

            var disclosures = Arrays.copyOfRange(parts, 1, parts.length - 1);
            var digests = Arrays.stream(disclosures).map(this::getDigestForDisclosure).toList();

            // todo test 2 mal s gliiche
            // todo check If any Disclosure was not referenced by digest value in the Issuer-signed JWT (directly or recursively via other Disclosures), the SD-JWT MUST be rejected.
            if (!digests.stream().allMatch(dig -> Collections.frequency(payload.get("_sd", List.class), dig) == 1)) {
                throw new Exception("Could not verify JWT problem with disclosures and _sd field");
            }

            Long exp = payload.get("exp", Long.class);
            Long nbf = payload.get("nbf", Long.class);

            if (nbf != null && Instant.now().isBefore(Instant.ofEpochSecond(nbf))) {
                throw new Exception("Could not verify JWT presentation is not yet valid");
            }

            if (exp != null && Instant.now().isAfter(Instant.ofEpochSecond(exp))) {
                throw new Exception("Could not verify JWT presentation is expired");
            }

        } catch (Exception e) {
            log.warn(e.getMessage());
        }

        return null;
    }

    // From https://www.baeldung.com/java-jwt-token-decode
    private Jwt<?, ?> parseAndValidateJWT(String token, PublicKey publicKey) throws Exception {

        JwtParser jwtParser = Jwts.parser()
                .verifyWith(publicKey)
                .build();

        try {
            Jwt<?, ?> test = jwtParser.parseSignedClaims(token);
            return test;
        } catch (Exception e) {
            // raise CredentialInvalidError
            throw new Exception("Could not verify JWT token integrity!", e);
        }
    }

    private PublicKey loadPublicKey() {
        try {
            var sanitized = publicKeyString.replaceAll("\n", "").replace("-----BEGIN PUBLIC KEY-----", "").replace("-----END PUBLIC KEY-----", "");
            byte[] encoded = Base64.getDecoder().decode(sanitized);
            KeyFactory kf = KeyFactory.getInstance("EC");
            EncodedKeySpec keySpec = new X509EncodedKeySpec(encoded);
            return kf.generatePublic(keySpec);
        } catch (Exception e) {
            log.error("Failed to load public key", e);
            return null;
        }
    }

    private String getDigestForDisclosure(String disclosureString) {
        return Disclosure.parse(disclosureString).digest();
    }

    // TODO test
    /*
    For example, the SHA-256 digest of the Disclosure WyI2cU1RdlJMNWhhaiIsICJmYW1pbHlfbmFtZSIsICJNw7ZiaXVzIl0 would be uutlBuYeMDyjLLTpf6Jxi7yNkEF35jdyWMn9U7b_RYY.
     */
}
